{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '42476870-3a5632db826cc102513b658b4';\nconst BASE_URL = 'https://pixabay.com';\nconst END_POINT = '/api/';\n\nexport async function searchImages(search, page) {\n  const PARAMS = `?key=${API_KEY}&q=${search}&image_type=photo&orientation=horizontal&safesearch=true&per_page=15&page=${page}`;\n  const url = `${BASE_URL}${END_POINT}${PARAMS}`;\n\n  try {\n    //рефакторинг кода на axios\n    const response = await axios.get(url);\n\n    if (response.status !== 200) {\n      throw new Error(response.status);\n    }\n    //рефакторинг\n    // const data = response.data;\n\n    if (response.data.hits && response.data.hits.length > 0) {\n      return response.data;\n    } else {\n      throw new Error('No images found');\n    }\n  } catch (error) {\n    throw new Error(\n      `Failed to fetch images from Pixabay API: ${error.message}`\n    );\n  }\n}\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\n\nconst lightbox = new SimpleLightbox('.img-container a', {\n  overlay: true,\n  overlayOpacity: 0.9,\n  animationSpeed: 1000,\n  scrollZoomFactor: 0.1,\n  navText: ['←', '→'],\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function renderMarkup(refs, pics, limit = 2000) {\n  refs.infoEl.innerHTML = '';\n\n  if (!pics || pics.length === 0) {\n    iziToast.error({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      position: 'center',\n      transitionIn: 'fadeInLeft',\n    });\n  } else {\n    pics.slice(0, limit).forEach(pic => {\n      const markup = createMarkup(pic);\n      refs.infoEl.insertAdjacentHTML('beforeend', markup);\n    });\n\n    lightbox.refresh();\n  }\n}\n\nfunction createMarkup(pic) {\n  return `<div class=\"image-box\">\n          <div class=\"general-frame\">\n\n            <div class=\"image-container\">\n              <a href=\"${pic.largeImageURL}\" data-lightbox=\"gallery\">\n              <img src=\"${pic.webformatURL}\" alt=\"${pic.tags}\" class=\"my-image\">\n              </a>\n            </div>\n             \n            <div class=\"image-body\">\n                <ul class=\"ul-item\">\n                 <li class=\"image-li\">Likes <span style=\"font-weight: normal;\">${pic.likes}</span></li>\n                 <li class=\"image-li\">Views <span style=\"font-weight: normal;\">${pic.views}</span></li>\n                 <li class=\"image-li\">Comments <span style=\"font-weight: normal;\">${pic.comments}</span></li>\n                 <li class=\"image-li\">Downloads <span style=\"font-weight: normal;\">${pic.downloads}</span></li>\n                </ul>\n              </div>\n          </div>\n    </div>`;\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { searchImages } from './js/pixabay-api.js';\nimport { renderMarkup } from './js/render-functions.js';\n\nconst refs = {\n  formEl: document.querySelector('.search-form'),\n  infoEl: document.querySelector('.img-container'),\n  loader: document.querySelector('.loader'),\n  btnLoadMore: document.querySelector('.js-btn-load'),\n};\n\nlet query;\nlet page; // чтоб запросы не повторялись\nlet maxPage;\n\nrefs.formEl.addEventListener('submit', onFormSubmit);\nrefs.btnLoadMore.addEventListener('click', onLoadMoreClick);\n\nfunction showLoadBtn() {\n  refs.btnLoadMore.classList.remove('is-hidden');\n}\nfunction hideLoadBtn() {\n  refs.btnLoadMore.classList.add('is-hidden');\n}\n\nasync function onFormSubmit(e) {\n  e.preventDefault();\n  query = e.target.elements.query.value.trim();\n  page = 1;\n  showLoader();\n  if (query === '') {\n    iziToast.error({\n      message: 'Please enter a search query',\n      position: 'center',\n      transitionIn: 'fadeInLeft',\n    });\n    return;\n  }\n\n  e.currentTarget.elements.query.value = ''; //очищаем поле ввода после отправки запроса\n\n  try {\n    const data = await searchImages(query, page);\n    refs.infoEl.innerHTML = '';\n    if (data.hits && data.hits.length > 0) {\n      renderMarkup(refs, data.hits);\n      hideLoader();\n      maxPage = Math.ceil(data.totalHits / 15);\n      // checkBtnVisibleStatus();\n    } else {\n      iziToast.error({\n        message: 'No images found for the given query',\n        position: 'center',\n        transitionIn: 'fadeInLeft',\n      });\n    }\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      message: 'Failed to fetch images. Please try again later.',\n      position: 'center',\n      transitionIn: 'fadeInLeft',\n    });\n  } finally {\n    e.target.reset();\n    checkBtnVisibleStatus();\n  }\n}\n\nasync function onLoadMoreClick() {\n  page += 1;\n  showLoader();\n\n  try {\n    const data = await searchImages(query, page);\n    renderMarkup(refs, data.hits); // Добавляем новые изображения к уже загруженным\n\n    hideLoader();\n    checkBtnVisibleStatus();\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      message: 'Failed to fetch more images. Please try again later.',\n      position: 'center',\n      transitionIn: 'fadeInLeft',\n    });\n    hideLoader();\n    // lightbox.refresh();\n  }\n  const height = refs.formEl.firstElementChild.getBoundingClientRect().height;\n  // Здесь можно также добавить скроллинг к новым изображениям, если это необходимо\n}\n\nfunction showLoader() {\n  refs.loader.classList.remove('is-hidden');\n}\n\nfunction hideLoader() {\n  refs.loader.classList.add('is-hidden');\n}\n\nfunction checkBtnVisibleStatus() {\n  if (page >= maxPage) {\n    hideLoadBtn();\n  } else {\n    showLoadBtn();\n  }\n}\n"],"names":["API_KEY","BASE_URL","END_POINT","searchImages","search","page","PARAMS","url","response","axios","error","lightbox","SimpleLightbox","renderMarkup","refs","pics","limit","iziToast","pic","markup","createMarkup","query","maxPage","onFormSubmit","onLoadMoreClick","showLoadBtn","hideLoadBtn","e","showLoader","data","hideLoader","checkBtnVisibleStatus"],"mappings":"owBAEA,MAAMA,EAAU,qCACVC,EAAW,sBACXC,EAAY,QAEX,eAAeC,EAAaC,EAAQC,EAAM,CAC/C,MAAMC,EAAS,QAAQN,CAAO,MAAMI,CAAM,6EAA6EC,CAAI,GACrHE,EAAM,GAAGN,CAAQ,GAAGC,CAAS,GAAGI,CAAM,GAE5C,GAAI,CAEF,MAAME,EAAW,MAAMC,EAAM,IAAIF,CAAG,EAEpC,GAAIC,EAAS,SAAW,IACtB,MAAM,IAAI,MAAMA,EAAS,MAAM,EAKjC,GAAIA,EAAS,KAAK,MAAQA,EAAS,KAAK,KAAK,OAAS,EACpD,OAAOA,EAAS,KAEhB,MAAM,IAAI,MAAM,iBAAiB,CAEpC,OAAQE,EAAO,CACd,MAAM,IAAI,MACR,4CAA4CA,EAAM,OAAO,EAC/D,CACG,CACH,CC3BA,MAAMC,EAAW,IAAIC,EAAe,mBAAoB,CACtD,QAAS,GACT,eAAgB,GAChB,eAAgB,IAChB,iBAAkB,GAClB,QAAS,CAAC,IAAK,GAAG,EAClB,aAAc,MACd,aAAc,GAChB,CAAC,EAEM,SAASC,EAAaC,EAAMC,EAAMC,EAAQ,IAAM,CACrDF,EAAK,OAAO,UAAY,GAEpB,CAACC,GAAQA,EAAK,SAAW,EAC3BE,EAAS,MAAM,CACb,QACE,2EACF,SAAU,SACV,aAAc,YACpB,CAAK,GAEDF,EAAK,MAAM,EAAGC,CAAK,EAAE,QAAQE,GAAO,CAClC,MAAMC,EAASC,EAAaF,CAAG,EAC/BJ,EAAK,OAAO,mBAAmB,YAAaK,CAAM,CACxD,CAAK,EAEDR,EAAS,QAAO,EAEpB,CAEA,SAASS,EAAaF,EAAK,CACzB,MAAO;AAAA;AAAA;AAAA;AAAA,yBAIgBA,EAAI,aAAa;AAAA,0BAChBA,EAAI,YAAY,UAAUA,EAAI,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iFAMqBA,EAAI,KAAK;AAAA,iFACTA,EAAI,KAAK;AAAA,oFACNA,EAAI,QAAQ;AAAA,qFACXA,EAAI,SAAS;AAAA;AAAA;AAAA;AAAA,WAKlG,CC5CA,MAAMJ,EAAO,CACX,OAAQ,SAAS,cAAc,cAAc,EAC7C,OAAQ,SAAS,cAAc,gBAAgB,EAC/C,OAAQ,SAAS,cAAc,SAAS,EACxC,YAAa,SAAS,cAAc,cAAc,CACpD,EAEA,IAAIO,EACAhB,EACAiB,EAEJR,EAAK,OAAO,iBAAiB,SAAUS,CAAY,EACnDT,EAAK,YAAY,iBAAiB,QAASU,CAAe,EAE1D,SAASC,GAAc,CACrBX,EAAK,YAAY,UAAU,OAAO,WAAW,CAC/C,CACA,SAASY,GAAc,CACrBZ,EAAK,YAAY,UAAU,IAAI,WAAW,CAC5C,CAEA,eAAeS,EAAaI,EAAG,CAK7B,GAJAA,EAAE,eAAc,EAChBN,EAAQM,EAAE,OAAO,SAAS,MAAM,MAAM,OACtCtB,EAAO,EACPuB,IACIP,IAAU,GAAI,CAChBJ,EAAS,MAAM,CACb,QAAS,8BACT,SAAU,SACV,aAAc,YACpB,CAAK,EACD,MACD,CAEDU,EAAE,cAAc,SAAS,MAAM,MAAQ,GAEvC,GAAI,CACF,MAAME,EAAO,MAAM1B,EAAakB,EAAOhB,CAAI,EAC3CS,EAAK,OAAO,UAAY,GACpBe,EAAK,MAAQA,EAAK,KAAK,OAAS,GAClChB,EAAaC,EAAMe,EAAK,IAAI,EAC5BC,IACAR,EAAU,KAAK,KAAKO,EAAK,UAAY,EAAE,GAGvCZ,EAAS,MAAM,CACb,QAAS,sCACT,SAAU,SACV,aAAc,YACtB,CAAO,CAEJ,OAAQP,EAAO,CACd,QAAQ,MAAMA,CAAK,EACnBO,EAAS,MAAM,CACb,QAAS,kDACT,SAAU,SACV,aAAc,YACpB,CAAK,CACL,QAAY,CACRU,EAAE,OAAO,QACTI,GACD,CACH,CAEA,eAAeP,GAAkB,CAC/BnB,GAAQ,EACRuB,IAEA,GAAI,CACF,MAAMC,EAAO,MAAM1B,EAAakB,EAAOhB,CAAI,EAC3CQ,EAAaC,EAAMe,EAAK,IAAI,EAE5BC,IACAC,GACD,OAAQrB,EAAO,CACd,QAAQ,MAAMA,CAAK,EACnBO,EAAS,MAAM,CACb,QAAS,uDACT,SAAU,SACV,aAAc,YACpB,CAAK,EACDa,GAED,CACchB,EAAK,OAAO,kBAAkB,sBAAuB,EAAC,MAEvE,CAEA,SAASc,GAAa,CACpBd,EAAK,OAAO,UAAU,OAAO,WAAW,CAC1C,CAEA,SAASgB,GAAa,CACpBhB,EAAK,OAAO,UAAU,IAAI,WAAW,CACvC,CAEA,SAASiB,GAAwB,CAC3B1B,GAAQiB,EACVI,IAEAD,GAEJ"}